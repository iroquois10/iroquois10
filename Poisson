get_score <- function (home, away){
  # hist_pair contains the statistics of the pairing for the last 5 seasons
  subset <- hist_pair.pl[which(hist_pair.pl$HomeTeam == home & hist_pair.pl$AwayTeam == away), ]
  
  # only use this method if we have at least 4 matches
  if ((dim(subset)[1] == 1) & (subset$match[1] > 3)){
    h_scored = rpois(1, subset$ave_home_scored[1])
    a_scored = rpois(1, subset$ave_away_scored[1])
  }
  # if we have no historical result of the match, then we use agregate result
  else{
    # take into account both attacking stat of home and defense stats of away
    h_scored = rpois(1, 1/2 * (ave[ave$Team == home,]$ave_scored_h +
                                 ave[ave$Team == away,]$ave_conceded_a))
                                 
    a_scored = rpois(1, 1/2 * (ave[ave$Team == away,]$ave_scored_a +
                                 ave[ave$Team == home,]$ave_conceded_h))
  }
  return (list(h_scored, a_scored))
}
